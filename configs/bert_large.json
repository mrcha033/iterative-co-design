{
  "task": "sst2",
  "pipeline": {
    "mode": "iterative",
    "repeats": 600,
    "warmup_iter": 100,
    "fixed_clock": true,
    "runner": "icd.runtime.runners_hf.hf_sequence_classifier_runner",
    "runner_context": {
      "model_loader": "icd.experiments.hf.load_hf_sequence_classifier",
      "model_loader_kwargs": {
        "model_name": "bert-large-uncased",
        "sequence_length": 384,
        "batch_size": 2,
        "prompt": [
          "This movie was wonderful!",
          "The plot was painfully slow.",
          "Performances were solid.",
          "I would not watch it again."
        ],
        "device": "cuda"
      }
    }
  },
  "graph": {
    "source": "pytorch",
    "normalize": "sym",
    "loader": "icd.experiments.hf.load_hf_sequence_classifier",
    "loader_kwargs": {
      "model_name": "bert-large-uncased",
      "sequence_length": 384,
      "batch_size": 2,
      "prompt": [
        "This movie was wonderful!",
        "The plot was painfully slow.",
        "Performances were solid.",
        "I would not watch it again."
      ],
      "device": "cuda"
    },
    "correlation": {
      "enable": true,
      "samples": 12,
      "normalize": "sym",
      "whiten": true,
      "transfer_batch_size": 4
    },
    "pytorch": {
      "hops": 2,
      "byte_weight": true,
      "reuse_decay": 0.65,
      "max_len": 384
    },
    "nnz_cap": 2500000
  },
  "solver": {
    "time_budget_s": 180,
    "refine_steps": 900,
    "k_blocks": 4,
    "rng_seed": 0
  },
  "pair": {
    "baseline_methods": [
      "linear",
      "louvain",
      "memory_aware",
      "hardware_aware"
    ]
  },
  "transform": {
    "sparsity": {"enable": false},
    "quant": {"enable": false},
    "kv": {"enable": false}
  },
  "measure": {
    "ncu_enable": false,
    "power_enable": false,
    "nvtx_enable": true
  },
  "quality": {
    "enable": true,
    "task": "sst2",
    "batch_size": 32,
    "max_length": 384,
    "max_samples": 192
  },
  "gates": {
    "sst2.acc_min": 0.90,
    "iter.latency_rel": -0.20,
    "iter.l2_pp": 10.0,
    "iter.ept_rel": -0.15,
    "quality.acc_drop_pp": -0.10
  },
  "report": {
    "out_dir": "runs/bert_large",
    "formats": ["html", "csv"]
  }
}
